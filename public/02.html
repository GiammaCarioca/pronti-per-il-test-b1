<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="data:;base64,iVBORw0KGgo=" />
    <title>Esercizio 2</title>
    <link rel="stylesheet" href="./styles/es02.css" />
    <script src="https://cdn.jsdelivr.net/gh/cferdinandi/bin/dist/bin.min.js"></script>
  </head>
  <body>
    <header>
      <h1>
        <span style="display: block">Prova 1:</span>
        Ecologia e ambiente
      </h1>
      <p>Comprensione della lettura</p>
    </header>
    <div class="wrapper">
      <h2 class="enunciado">
        Leggi il testo qua sotto e poi svolgi l'esercizio.
      </h2>

      <main>
        <article>
          <h3>Regole e consigli per la raccolta differenziata</h3>
          <p>
            Le risorse del pianeta non sono illimitate e un uso sbagliato e
            spropositato accelera il loro esaurimento.
          </p>

          <h4>La raccolta differenziata</h4>
          <p>
            L’attività svolta da ciascuno di noi nella raccolta differenziata è
            molto importante: separando i rifiuti e dividendoli in maniera
            corretta, recuperiamo materiali utili alla produzione di nuovi
            oggetti.
          </p>

          <h4>Come fare la raccolta differenziata</h4>
          <p>
            La raccolta può essere effettuata in vari modi: raccolta porta a
            porta e per mezzo di contenitori stradali (cassonetti) di forme e
            colori diversi. La forma e il colore dei vari contenitori possono
            variare lievemente a seconda della zona in cui si abita, per questo
            motivo è importante controllare sempre le indicazioni riportate sui
            cassonetti o sul kit (sacchetti o appositi cestini) della raccolta
            porta a porta.
          </p>

          <h4>Casi particolari</h4>
          <p>
            L’olio da cucina non deve essere versato nello scarico della cucina
            o nella rete fognaria, ma deve essere raccolto in un recipiente da
            gettare nell’apposito punto raccolta presente nel proprio Comune.
          </p>
          <p>
            Le pile e le batterie devono essere smaltite presso i punti vendita
            di questi beni, o altre strutture che hanno attivato il servizio
            gratuito di ritiro tramite appositi contenitori per la raccolta.
          </p>
          <p>
            Le medicine devono essere gettate in appositi contenitori presente
            nel proprio Comune oppure presso strutture (come ad esempio le
            farmacie e ambulatori), che hanno attivato il servizio di raccolta.
          </p>
          <p>
            I rifiuti ingombranti e le potature non devono essere posti a fianco
            dei cassonetti. Per il ritiro di questi rifiuti esiste un servizio
            apposito su appuntamento.
          </p>
          <p>
            Per gestire la raccolta e lo smaltimento dei rifiuti ogni anno i
            cittadini devono pagare una tassa: la TARI.
          </p>
        </article>

        <section>
          <header>
            <h3 class="enunciado">
              <span style="display: block"
                >Leggi le affermazioni seguenti.</span
              >
              Indica se l'affermazione è presente (SÌ) o se NON è presente (NO).
            </h3>
            <p>Non tutte sono presenti nel testo.</p>
          </header>
          <form action="#" id="esercizio02" autocomplete="off">
            <ol>
              <li>
                <fieldset>
                  <legend>
                    Le risorse sono limitate e finiranno prima del tempo se le
                    usiamo in modo sbagliato.
                  </legend>
                  <div class="radio-wrapper" data-risp="">
                    <input
                      type="radio"
                      name="answer01"
                      value="true"
                      id="answer01-si"
                    />
                    <label for="answer01-si">Sì</label>
                    <input
                      type="radio"
                      name="answer01"
                      value="false"
                      id="answer01-no"
                    />
                    <label for="answer01-no">No</label>
                  </div>
                </fieldset>
              </li>

              <li>
                <fieldset>
                  <legend>
                    Se non si fa la raccolta differenziata si prende una multa.
                  </legend>
                  <div class="radio-wrapper" data-risp="">
                    <input
                      type="radio"
                      name="answer02"
                      value="true"
                      id="answer02-si"
                    />
                    <label for="answer02-si">Sì</label>
                    <input
                      type="radio"
                      name="answer02"
                      value="false"
                      id="answer02-no"
                    />
                    <label for="answer02-no">No</label>
                  </div>
                </fieldset>
              </li>

              <li>
                <fieldset>
                  <legend>
                    Separando correttamente i rifiuti, recuperiamo materiali per
                    creare nuovi oggetti.
                  </legend>
                  <div class="radio-wrapper" data-risp="">
                    <input
                      type="radio"
                      name="answer03"
                      value="true"
                      id="answer03-si"
                    />
                    <label for="answer03-si">Sì</label>
                    <input
                      type="radio"
                      name="answer03"
                      value="false"
                      id="answer03-no"
                    />
                    <label for="answer03-no">No</label>
                  </div>
                </fieldset>
              </li>

              <li>
                <fieldset>
                  <legend>
                    I contenitori della raccolta differenziata sono uguali per
                    tutti.
                  </legend>
                  <div class="radio-wrapper" data-risp="">
                    <input
                      type="radio"
                      name="answer04"
                      value="true"
                      id="answer04-si"
                    />
                    <label for="answer04-si">Sì</label>
                    <input
                      type="radio"
                      name="answer04"
                      value="false"
                      id="answer04-no"
                    />
                    <label for="answer04-no">No</label>
                  </div>
                </fieldset>
              </li>

              <li>
                <fieldset>
                  <legend>
                    L’olio da cucina va raccolto in un contenitore da portare in
                    discarica.
                  </legend>
                  <div class="radio-wrapper" data-risp="">
                    <input
                      type="radio"
                      name="answer05"
                      value="true"
                      id="answer05-si"
                    />
                    <label for="answer05-si">Sì</label>
                    <input
                      type="radio"
                      name="answer05"
                      value="false"
                      id="answer05-no"
                    />
                    <label for="answer05-no">No</label>
                  </div>
                </fieldset>
              </li>

              <li>
                <fieldset>
                  <legend>
                    Le pile e le batterie vanno buttate presso i negozi che le
                    vendono
                  </legend>
                  <div class="radio-wrapper" data-risp="">
                    <input
                      type="radio"
                      name="answer06"
                      value="true"
                      id="answer06-si"
                    />
                    <label for="answer06-si">Sì</label>
                    <input
                      type="radio"
                      name="answer06"
                      value="false"
                      id="answer06-no"
                    />
                    <label for="answer06-no">No</label>
                  </div>
                </fieldset>
              </li>

              <li>
                <fieldset>
                  <legend>
                    Le medicine non si possono buttare insieme agli altri
                    rifiuti.
                  </legend>
                  <div class="radio-wrapper" data-risp="">
                    <input
                      type="radio"
                      name="answer07"
                      value="true"
                      id="answer07-si"
                    />
                    <label for="answer07-si">Sì</label>
                    <input
                      type="radio"
                      name="answer07"
                      value="false"
                      id="answer07-no"
                    />
                    <label for="answer07-no">No</label>
                  </div>
                </fieldset>
              </li>

              <li>
                <fieldset>
                  <legend>
                    Le pile le batterie possono essere smaltite solo se
                    completamente esaurite.
                  </legend>
                  <div class="radio-wrapper" data-risp="">
                    <input
                      type="radio"
                      name="answer08"
                      value="true"
                      id="answer08-si"
                    />
                    <label for="answer08-si">Sì</label>
                    <input
                      type="radio"
                      name="answer08"
                      value="false"
                      id="answer08-no"
                    />
                    <label for="answer08-no">No</label>
                  </div>
                </fieldset>
              </li>

              <li>
                <fieldset>
                  <legend>
                    Per rifiuti ingombranti si intende tutto ciò che non entra
                    nel cassonetto.
                  </legend>
                  <div class="radio-wrapper" data-risp="">
                    <input
                      type="radio"
                      name="answer09"
                      value="true"
                      id="answer09-si"
                    />
                    <label for="answer09-si">Sì</label>
                    <input
                      type="radio"
                      name="answer09"
                      value="false"
                      id="answer09-no"
                    />
                    <label for="answer09-no">No</label>
                  </div>
                </fieldset>
              </li>

              <li>
                <fieldset>
                  <legend>
                    Il recipiente per smaltire l’olio da cucina viene fornito
                    dal Comune.
                  </legend>
                  <div class="radio-wrapper" data-risp="">
                    <input
                      type="radio"
                      name="answer10"
                      value="true"
                      id="answer10-si"
                    />
                    <label for="answer10-si">Sì</label>
                    <input
                      type="radio"
                      name="answer10"
                      value="false"
                      id="answer10-no"
                    />
                    <label for="answer10-no">No</label>
                  </div>
                </fieldset>
              </li>

              <li>
                <fieldset>
                  <legend>
                    Per il ritiro dei rifiuti ingombranti devo prendere un
                    appuntamento.
                  </legend>
                  <div class="radio-wrapper" data-risp="">
                    <input
                      type="radio"
                      name="answer11"
                      value="true"
                      id="answer11-si"
                    />
                    <label for="answer11-si">Sì</label>
                    <input
                      type="radio"
                      name="answer11"
                      value="false"
                      id="answer11-no"
                    />
                    <label for="answer11-no">No</label>
                  </div>
                </fieldset>
              </li>

              <li>
                <fieldset>
                  <legend>
                    La TARI è una tassa annuale per la raccolta dei rifiuti.
                  </legend>
                  <div class="radio-wrapper" data-risp="">
                    <input
                      type="radio"
                      name="answer12"
                      value="true"
                      id="answer12-si"
                    />
                    <label for="answer12-si">Sì</label>
                    <input
                      type="radio"
                      name="answer12"
                      value="false"
                      id="answer12-no"
                    />
                    <label for="answer12-no">No</label>
                  </div>
                </fieldset>
              </li>
            </ol>

            <button type="submit">Controlla</button>
          </form>
          <div id="difference"></div>
        </section>
      </main>

      <footer>
        <a href="./prova01es01.html">Back</a>
        <a href="./index.html">Home</a>
        <a href="./prova01es03.html">Next</a>
      </footer>
    </div>

    <script>
      const solutions = [
        "true",
        "false",
        "true",
        "false",
        "false",
        "true",
        "true",
        "false",
        "false",
        "false",
        "true",
        "true",
      ];

      const esercizio02 = document.getElementById("esercizio02");

      esercizio02.addEventListener("submit", (e) => {
        e.preventDefault();

        // 24 fields
        const fields = Array.from(
          esercizio02.querySelectorAll("input[type='radio']")
        );

        // if checked pass value to the parent
        fields.forEach((field, idx) => {
          field.checked ? (field.parentNode.dataset.risp = field.value) : "";
        });

        // 12 radio groups
        const radioGroup = Array.from(
          esercizio02.querySelectorAll("div[data-risp]")
        );

        // Get user answers / item checked by user
        const answers = radioGroup.map((group) => group.dataset.risp);
        // console.log(answers);

        // Keeping score
        let score = 0;

        //
        const checkAnswer = (answer, idx) => {
          const radioGroup = Array.from(
            esercizio02.querySelectorAll("div[data-risp]")
          );

          const labels = Array.from(radioGroup[idx].querySelectorAll("label"));

          if (answer === "") {
            return labels.forEach((label) => label.classList.add("empty"));
          }

          if (answer === solutions[idx]) {
            score++;
            console.log("👍");
            answer = "right";
          } else {
            console.log("👎");
            answer = "wrong";
          }

          if (answer === "right") {
            labels.forEach((label) =>
              label.previousElementSibling.checked
                ? label.classList.add("right")
                : label.classList.add("error")
            );
            labels.forEach((label) => label.classList.remove("empty"));
          }

          if (answer === "wrong") {
            labels.forEach((label) =>
              label.previousElementSibling.checked
                ? label.classList.add("error")
                : label.classList.add("right")
            );
            labels.forEach((label) => label.classList.remove("empty"));
          }
        };

        // Check each given answser
        answers.forEach((answer, idx) => checkAnswer(answer, idx));

        // Instantiate a new localStorage instance
        const myBin = new Bin("_prova01_");

        // Get data from storage if it exists
        const prevData = myBin.get();

        if (!prevData) {
          // Store answers
          myBin.set([{ es02: answers }]);
        } else {
          // Replace only "es02 answers"
          const newAnswers = [
            ...prevData.filter((data) => !data["es02"]),
            { es02: answers },
          ];
          myBin.set(newAnswers);
        }

        document.querySelector(
          "#difference"
        ).textContent = `${score} risposte corrette!`;
      });

      function init() {
        const radioGroup = Array.from(
          esercizio02.querySelectorAll("div[data-risp]")
        );

        // Instantiate a new localStorage instance
        const myBin = new Bin("_prova01_");

        // Get data from storage if it exists
        const storedAnswers = myBin.get();
        // console.log(storedAnswers[0].es02);

        if (!storedAnswers) return;

        const es02Answers = storedAnswers.filter((stored) => stored.es02);
        // console.log(es02Answers[0].es02);

        es02Answers[0].es02.forEach((field, idx) => {
          const radioGroup = Array.from(
            esercizio02.querySelectorAll("div[data-risp]")
          );

          const labels = Array.from(radioGroup[idx].querySelectorAll("label"));

          if (field === "") {
            labels.forEach((label) => label.classList.add("empty"));
            return;
          }

          if (field === "true") {
            radioGroup[idx].dataset.risp = "true";
            radioGroup[idx].children[0].checked = true;
          }

          if (field === "false") {
            radioGroup[idx].dataset.risp = "false";
            radioGroup[idx].children[2].checked = "true";
          }
        });
      }

      // Remove orange background on click
      const labels = Array.from(document.querySelectorAll("label"));

      labels.forEach((label) => {
        label.addEventListener("click", (e) => {
          e.target.classList.remove("empty");
          e.target.parentNode
            .querySelector(".empty")
            ?.classList.remove("empty");
        });
      });

      init();
    </script>
  </body>
</html>
